<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Planilha de Produtos</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
    button { margin: 10px 5px; padding: 10px 15px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Planilha de Produtos</h1>
  <button onclick="copiarHTML()">ðŸ“‹ Copiar Planilha</button>
  <button onclick="baixarHTML()">ðŸ’¾ Baixar CÃ³pia</button>
  <table id="tabela">
    <thead>
      <tr>
        <th>ID</th>
        <th>Loja</th>
        <th>Nome</th>
        <th>PreÃ§o</th>
        <th>Imagem</th>
        <th>Link</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script>
    // Salvar conteÃºdo HTML para download
    function baixarHTML() {
      const blob = new Blob([document.documentElement.outerHTML], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'planilha.html';
      a.click();
      URL.revokeObjectURL(url);
    }

    // Copiar conteÃºdo HTML para Ã¡rea de transferÃªncia
    function copiarHTML() {
      navigator.clipboard.writeText(document.documentElement.outerHTML).then(() => {
        alert('Planilha copiada com sucesso!');
      }).catch(err => {
        alert('Erro ao copiar: ' + err);
      });
    }

    // Recebe os dados do Tampermonkey
    window.addEventListener('message', (event) => {
      if (event.origin !== 'https://devixippex.github.io') return;
      const { id, loja, nome, preco, imagem, url } = event.data;
      if (!id || !nome || !preco || !imagem || !url || !loja) return;

      const tabela = document.querySelector('#tabela tbody');
      const linha = document.createElement('tr');
      linha.innerHTML = `
        <td>${id}</td>
        <td>${loja}</td>
        <td>${nome}</td>
        <td>${preco}</td>
        <td><img src="${imagem}" alt="Imagem" width="80"></td>
        <td><a href="${url}" target="_blank">Ver produto</a></td>
      `;
      tabela.appendChild(linha);
    });
  </script>
</body>
</html>
